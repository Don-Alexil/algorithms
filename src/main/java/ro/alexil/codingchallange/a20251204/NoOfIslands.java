package ro.alexil.codingchallange.a20251204;

import java.util.List;
import java.util.Set;

public class NoOfIslands {

    public record Point(int x, int y) {

        public Point up() {
            return x - 1 < 0 ? null : new Point(x -1, y );
        }

        public Point left() {
            return y - 1 < 0 ? null : new Point(x, y-1);
        }
    }

    public static class IslandMap {
        int islands = 0;
        int counter = 0;
        public int[][] map;

        public IslandMap(int rows, int cols) {
            this.map = new int[rows][cols];
        }

        public  void addPoint(Point point) {
            Point left = point.left();
            Point up = point.up();
            if(left != null && up != null) {
                int upIslandId = map[up.x][up.y];
                int leftIslandId = map[left.x][left.y];
                if(upIslandId != 0 && leftIslandId != 0 && upIslandId != leftIslandId) {
                    // System.out.println("Merging islands at point: " + point + " upIslandId: " + upIslandId + " leftIslandId: " + leftIslandId);
                    // Merge islands
                    int targetId = Math.min(upIslandId, leftIslandId);
                    int replaceId = Math.max(upIslandId, leftIslandId);
                    for(int i = 0; i <= point.x; i++) {
                        for(int j = 0; j < map[i].length; j++) {
                            if(map[i][j] == replaceId) {
                                map[i][j] = targetId;
                            }
                        }
                    }
                    counter--;
                    map[point.x][point.y] = targetId;
                    return;
                }
            }
            if(left != null) {
                int leftIslandId = map[left.x][left.y];
                if(leftIslandId != 0) {
                    map[point.x][point.y] = leftIslandId;
                    return;
                }
            }
            if(up != null) {
                int upIslandId  = map[up.x][up.y];
                if(upIslandId != 0) {
                    map[point.x][point.y] = upIslandId;
                    return;
                }

            }
            counter++;
            islands++;
            map[point.x][point.y] = islands;
        }

        public int getIslands() {
            return counter;
        }

        public void printMap() {
            System.out.println("Grid size" + map.length + " x " + map[0].length);
            for (int[] row : map) {
                for (int cell : row) {
                    System.out.printf("%4s", String.valueOf(cell));
                }
                System.out.println();
            }
        }
    }

    public static int numIslands(List<List<Character>> grid) {
        int rows = grid.size();
        if (rows == 0) return 0;
        int cols = grid.get(0).size();
        var islandMap = new IslandMap(rows, cols);

        // Replace this placeholder return statement with your code
        for(int i = 0; i < rows; i++) {
            for(int j = 0; j < cols; j++) {
                if(grid.get(i).get(j) == '1') {
                    islandMap.addPoint(new Point(i, j));
                }
            }
        }
        islandMap.printMap();
        return islandMap.getIslands();
    }

    public static void main(String[] args) {
        var grid =
        List.of(
                List.of('1', '1', '0', '0', '0'),
                List.of('1', '1', '0', '0', '0'),
                List.of('0', '0', '1', '0', '0'),
                List.of('0', '0', '0', '1', '1')
        );

        var grid2 =         List.of(
                List.of('1', '1', '1', '1', '0'),
                List.of('1', '0', '0', '0', '1'),
                List.of('1', '0', '0', '1', '1'),
                List.of('0', '1', '0', '1', '0'),
                List.of('1', '1', '0', '1', '1')
                );

        var grid3 = List.of(
                List.of('0','0','1','0','0','1','0','1','1','1','0','1','1','0','0','1','1','1','0','1','0','1'),
                List.of('1','1','0','0','0','0','1','0','0','0','0','0','1','0','1','1','0','1','0','1','0','0'),
                List.of('1','1','1','1','1','1','0','1','0','1','1','0','1','1','1','0','1','0','0','0','1','1'),
                List.of('0','1','0','0','1','0','1','0','1','0','1','1','0','0','0','0','1','1','0','1','1','1'),
                List.of('0','0','0','0','1','0','1','1','1','0','0','0','0','0','1','1','1','1','1','1','1','1'),
                List.of('0','1','1','0','1','1','1','0','0','0','0','1','0','0','1','0','0','1','1','0','1','1'),
                List.of('0','1','0','0','1','1','1','1','0','1','0','0','0','1','1','1','0','1','1','1','0','1'),
                List.of('0','0','0','1','1','1','0','1','1','1','1','0','0','0','0','0','0','0','1','1','0','0'),
                List.of('1','0','1','1','0','0','0','0','1','1','0','1','1','0','0','1','1','1','1','0','0','0'),
                List.of('0','1','0','0','0','0','1','1','0','0','0','1','1','1','1','1','1','1','1','1','0','1'),
                List.of('1','0','1','0','0','1','0','0','1','0','1','1','0','0','1','1','0','1','1','1','0','0'),
                List.of('0','0','1','0','1','0','1','0','1','1','0','1','0','0','0','0','1','0','1','1','0','0'),
                List.of('1','1','1','1','1','0','1','0','0','1','1','1','1','1','0','0','1','1','0','0','1','1'),
                List.of('0','1','0','0','0','1','0','0','0','1','0','1','0','1','1','1','1','1','0','0','1','1'),
                List.of('0','0','1','1','1','0','1','1','0','0','1','1','1','1','1','0','0','0','0','0','0','1'),
                List.of('0','1','0','0','1','1','0','0','1','0','1','1','1','1','1','1','1','1','0','0','0','1'),
                List.of('1','0','0','1','1','1','1','1','1','0','0','1','0','0','1','0','0','0','0','0','1','1'),
                List.of('0','0','1','1','0','1','0','0','1','0','1','0','1','1','0','0','0','1','0','1','0','0'),
                List.of('1','0','0','1','0','1','1','1','0','0','0','0','1','1','0','1','0','1','0','0','0','1'),
                List.of('0','1','0','0','0','1','0','0','0','0','1','0','0','1','0','1','1','1','0','0','0','1'),
                List.of('1','1','0','0','0','0','1','1','0','0','1','1','1','0','0','1','0','0','0','1','1','0'),
                List.of('0','0','1','0','1','1','0','0','1','1','0','1','1','1','0','1','1','1','1','1','1','1'),
                List.of('1','0','0','1','0','1','0','0','0','1','1','1','0','1','0','1','1','1','1','0','1','0'),
                List.of('1','0','1','1','0','1','1','0','1','1','1','0','1','1','0','0','0','1','1','1','1','1'),
                List.of('0','1','0','1','1','0','0','0','0','0','1','0','1','1','0','1','1','1','1','1','0','1'),
                List.of('1','1','0','1','0','0','0','0','1','1','0','0','0','1','0','0','1','0','1','0','0','0'),
                List.of('0','1','1','1','1','0','0','1','0','0','0','1','1','1','0','0','1','0','1','0','1','0'),
                List.of('0','1','1','0','0','1','0','0','1','1','0','0','0','0','0','0','1','0','0','0','1','0'),
                List.of('1','1','1','1','0','1','0','1','0','1','0','0','1','0','0','1','1','0','0','1','0','0'),
                List.of('0','0','1','1','1','1','0','0','0','1','1','0','0','0','0','0','0','0','1','0','1','0'),
                List.of('0','1','0','1','1','1','0','1','1','0','0','0','1','1','1','1','0','0','0','1','0','0'),
                List.of('0','1','0','1','0','1','1','0','1','1','1','0','1','0','1','1','1','1','0','0','1','1'),
                List.of('1','0','1','0','1','1','0','1','0','1','0','0','1','1','0','0','1','0','1','0','1','0'),
                List.of('0','1','1','0','0','1','0','1','0','0','0','1','0','1','0','1','0','0','1','0','1','0'),
                List.of('1','0','1','1','0','0','0','0','1','0','1','1','1','1','1','1','0','1','1','0','1','1'),
                List.of('0','1','1','1','0','0','0','0','0','0','0','0','1','1','0','0','1','0','1','0','0','0'));


        var grid4 = List.of(List.of('0','0','1','0','0','1','0','1','1','1','0','1','1','0','0','1','1','1','0','1','0','1'),List.of('1','1','0','0','0','0','1','0','0','0','0','0','1','0','1','1','0','1','0','1','0','0'),List.of('1','1','1','1','1','1','0','1','0','1','1','0','1','1','1','0','1','0','0','0','1','1'),List.of('0','1','0','0','1','0','1','0','1','0','1','1','0','0','0','0','1','1','0','1','1','1'),List.of('0','0','0','0','1','0','1','1','1','0','0','0','0','0','1','1','1','1','1','1','1','1'),List.of('0','1','1','0','1','1','1','0','0','0','0','1','0','0','1','0','0','1','1','0','1','1'),List.of('0','1','0','0','1','1','1','1','0','1','0','0','0','1','1','1','0','1','1','1','0','1'),List.of('0','0','0','1','1','1','0','1','1','1','1','0','0','0','0','0','0','0','1','1','0','0'),List.of('1','0','1','1','0','0','0','0','1','1','0','1','1','0','0','1','1','1','1','0','0','0'),List.of('0','1','0','0','0','0','1','1','0','0','0','1','1','1','1','1','1','1','1','1','0','1'),List.of('1','0','1','0','0','1','0','0','1','0','1','1','0','0','1','1','0','1','1','1','0','0'),List.of('0','0','1','0','1','0','1','0','1','1','0','1','0','0','0','0','1','0','1','1','0','0'),List.of('1','1','1','1','1','0','1','0','0','1','1','1','1','1','0','0','1','1','0','0','1','1'),List.of('0','1','0','0','0','1','0','0','0','1','0','1','0','1','1','1','1','1','0','0','1','1'),List.of('0','0','1','1','1','0','1','1','0','0','1','1','1','1','1','0','0','0','0','0','0','1'),List.of('0','1','0','0','1','1','0','0','1','0','1','1','1','1','1','1','1','1','0','0','0','1'),List.of('1','0','0','1','1','1','1','1','1','0','0','1','0','0','1','0','0','0','0','0','1','1'),List.of('0','0','1','1','0','1','0','0','1','0','1','0','1','1','0','0','0','1','0','1','0','0'),List.of('1','0','0','1','0','1','1','1','0','0','0','0','1','1','0','1','0','1','0','0','0','1'),List.of('0','1','0','0','0','1','0','0','0','0','1','0','0','1','0','1','1','1','0','0','0','1'),List.of('1','1','0','0','0','0','1','1','0','0','1','1','1','0','0','1','0','0','0','1','1','0'),List.of('0','0','1','0','1','1','0','0','1','1','0','1','1','1','0','1','1','1','1','1','1','1'),List.of('1','0','0','1','0','1','0','0','0','1','1','1','0','1','0','1','1','1','1','0','1','0'),List.of('1','0','1','1','0','1','1','0','1','1','1','0','1','1','0','0','0','1','1','1','1','1'),List.of('0','1','0','1','1','0','0','0','0','0','1','0','1','1','0','1','1','1','1','1','0','1'),List.of('1','1','0','1','0','0','0','0','1','1','0','0','0','1','0','0','1','0','1','0','0','0'),List.of('0','1','1','1','1','0','0','1','0','0','0','1','1','1','0','0','1','0','1','0','1','0'),List.of('0','1','1','0','0','1','0','0','1','1','0','0','0','0','0','0','1','0','0','0','1','0'),List.of('1','1','1','1','0','1','0','1','0','1','0','0','1','0','0','1','1','0','0','1','0','0'),List.of('0','0','1','1','1','1','0','0','0','1','1','0','0','0','0','0','0','0','1','0','1','0'),List.of('0','1','0','1','1','1','0','1','1','0','0','0','1','1','1','1','0','0','0','1','0','0'),List.of('0','1','0','1','0','1','1','0','1','1','1','0','1','0','1','1','1','1','0','0','1','1'),List.of('1','0','1','0','1','1','0','1','0','1','0','0','1','1','0','0','1','0','1','0','1','0'),List.of('0','1','1','0','0','1','0','1','0','0','0','1','0','1','0','1','0','0','1','0','1','0'),List.of('1','0','1','1','0','0','0','0','1','0','1','1','1','1','1','1','0','1','1','0','1','1'),List.of('0','1','1','1','0','0','0','0','0','0','0','0','1','1','0','0','1','0','1','0','0','0'));
        int result = numIslands(grid4);
        System.out.println("Number of islands: " + result);
    }
}
